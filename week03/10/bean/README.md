
---

## 8. Chapter 4: 네트워크 계층 핵심 요약

### 8.1 네트워크 계층 개요

**주요 목표:**
1. **포워딩 vs 라우팅** 구분
2. **라우터 내부 구조** 이해
3. **IP 프로토콜** (IPv4, IPv6) 학습
4. **라우팅 알고리즘** (링크 상태, 거리 벡터) 이해
5. **인터넷 라우팅** (RIP, OSPF, BGP) 학습
6. **브로드캐스트/멀티캐스트** 라우팅

### 8.2 IP 데이터그램 형식

**IP 헤더 구조 (20바이트):**
- **Version**: IP 프로토콜 버전 (IPv4=4, IPv6=6)
- **Header Length**: 헤더 길이 (4바이트 단위)
- **Type of Service**: 데이터 우선순위 (QoS)
- **Total Length**: 전체 데이터그램 길이
- **Identifier**: 단편화/재조립 식별자
- **Flags**: 단편화 관련 플래그
- **Fragment Offset**: 단편화된 패킷 위치
- **TTL**: 남은 홉 수 (무한루프 방지)
- **Upper Layer Protocol**: 상위 계층 프로토콜
- **Header Checksum**: 헤더 오류 검출
- **Source/Destination IP**: 송수신 IP 주소

**오버헤드:**
- TCP 헤더: 20바이트
- IP 헤더: 20바이트
- **총 오버헤드**: 40바이트 + 애플리케이션 계층

### 8.3 IP 주소 체계 (IPv4)

**IP 주소 정의:**
- **32비트 고유 숫자**
- **인터페이스 식별** (호스트, 라우터 등)
- **점 표기법**: 12.34.158.5

**계층적 주소 체계:**
- **인터넷**: "inter-network" (네트워크 간 연결)
- **목적**: 호스트가 아닌 네트워크를 연결
- **확장성**: 네트워크 단위로 주소화

**IP 접두사 (Prefix):**
- **표기법**: a.b.c.d/x (x는 서브넷 비트 수)
- **예시**: 12.34.158.0/24 (24비트 접두사, 2^8개 주소)

### 8.4 확장성 문제와 해결책

**문제:**
- 모든 라우터가 모든 호스트 정보 필요
- 라우팅 테이블 크기 비대화
- 새 호스트 추가 시 모든 라우터 업데이트

**해결책:**
- **계층적 주소 할당**: 관련 호스트를 공통 서브넷에서 번호 매김
- **예시**: 1.2.3.0/24 (왼쪽 LAN), 5.6.7.0/24 (오른쪽 LAN)
- **결과**: 라우터가 네트워크 단위로만 정보 보유

### 8.5 CIDR (Classless Inter-Domain Routing)

**개념:**
- **두 개의 32비트 숫자**로 네트워크 표현
- **네트워크 번호 = IP 주소 + 마스크**
- **표기법**: a.b.c.d/x 형태

**예시:**
```
IP 주소: 12.4.0.0
마스크: 255.254.0.0
결과: 12.4.0.0/15 (15비트 네트워크 접두사)
```

**계층적 주소 할당:**
```
ICANN → RIR → ISP → 고객
```

### 8.6 최장 접두사 매칭

**문제:**
- 포워딩 테이블에 여러 매칭 가능
- **예시**: 201.10.0.0/21과 201.10.6.0/23 모두 매칭

**해결책:**
- **최장 접두사 매칭**: 가장 구체적인 접두사 선택
- **예시**: 201.10.6.17 → 201.10.6.0/23 선택

### 8.7 서브넷

**정의:**
- **동일한 서브넷 부분**의 IP 주소를 가진 장치 인터페이스
- **물리적으로 직접 도달 가능** (중간 라우터 없음)

**예시:**
- 223.1.1.1, 223.1.1.2, 223.1.1.3, 223.1.1.4
- **서브넷**: 223.1.1 (고차 비트)
- **호스트**: 1, 2, 3, 4 (저차 비트)

### 8.8 핵심 개념 정리

1. **IP 데이터그램**: 네트워크 계층의 기본 전송 단위
2. **계층적 주소 체계**: 확장성을 위한 네트워크 단위 주소화
3. **CIDR**: 클래스 없는 도메인 간 라우팅
4. **최장 접두사 매칭**: 포워딩 테이블에서 가장 구체적인 접두사 선택
5. **서브넷**: 물리적으로 연결된 호스트 그룹
6. **확장성**: 약 400,000개의 접두사로 인터넷 관리